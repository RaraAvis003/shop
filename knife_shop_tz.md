# ТЕХНИЧЕСКОЕ ЗАДАНИЕ
## Интернет-магазин ножей и топоров

---

## 1. ОБЩАЯ ИНФОРМАЦИЯ ПРОЕКТА

### 1.1 Описание проекта
Интернет-магазин авторских ножей и топоров ручной работы с возможностью покупки товаров "в наличии" и оформления заказов "под заказ".

### 1.2 Масштаб проекта
- **Количество товаров**: до 100 единиц
- **Ожидаемая нагрузка**: 10-100 заказов в день
- **Команда разработки**: 1 разработчик (solo dev)
- **Сроки**: MVP как можно раньше, но не критично

### 1.3 Инфраструктура
- **VPS характеристики**: 2 CPU, 4-8 GB RAM
- **Операционная система**: Linux (Ubuntu 22.04 LTS рекомендуется)
- **Контейнеризация**: Docker + Docker Compose

---

## 2. ТЕХНОЛОГИЧЕСКИЙ СТЕК

### 2.1 Backend
```yaml
Фреймворк: Django 5.0
API: Django REST Framework (DRF)
База данных: PostgreSQL 15
Кэш/Очереди: Redis 7
Хранилище файлов: MinIO (S3-совместимое)
Async задачи: Celery + Redis
Web сервер: Gunicorn
Reverse proxy: Nginx
Платежи: ЮKassa API
```

### 2.2 Frontend
```yaml
Фреймворк: Next.js 14 (App Router)
Язык: TypeScript (опционально, можно JavaScript)
Стилизация: Tailwind CSS
UI компоненты: shadcn/ui
Иконки: lucide-react
Слайдеры: Swiper.js
```

### 2.3 DevOps
```yaml
Контейнеризация: Docker, Docker Compose
CI/CD: GitHub Actions или GitLab CI
SSL: Let's Encrypt (автоматическое обновление)
Мониторинг: Django Debug Toolbar (dev), логи (prod)
Резервное копирование: PostgreSQL dump + MinIO sync
```

---

## 3. СТРУКТУРА САЙТА

### 3.1 Список страниц

#### Обязательные страницы (MVP):
1. **Главная** (`/`)
   - Hero-слайдер (fullscreen)
   - Секция "Новинки" (4-6 карточек)
   - Секция "Популярные категории" (плитка 3-4 шт)
   - Преимущества магазина (3 блока)
   - Footer

2. **Каталог** (`/catalog`)
   - Фильтры (sidebar)
   - Сортировка (dropdown)
   - Grid товаров (3-4 колонки desktop, 1-2 mobile)
   - Пагинация

3. **Карточка товара** (`/product/[slug]`)
   - Галерея фото (lightbox при клике)
   - Название, цена, статус наличия
   - Кнопка "Купить" / "Заказать"
   - Таблица характеристик
   - Описание (rich text)
   - Отзывы
   - "Похожие товары" (слайдер 4-6 шт)

4. **Корзина** (`/cart`)
   - Список товаров с миниатюрами
   - Разделение: "В наличии" и "Под заказ"
   - Итоговая сумма
   - Кнопка "Оформить заказ"

5. **Оформление заказа** (`/checkout`)
   - Форма контактов (имя, email, телефон)
   - Адрес доставки
   - Способ доставки (список)
   - Способ оплаты (карта, СБП через ЮKassa)
   - Подтверждение заказа

6. **Личный кабинет** (`/account`)
   - Профиль пользователя
   - Список заказов (статусы, детали)
   - История покупок
   - Возможность повторить заказ

7. **Избранное** (`/wishlist`)
   - Grid товаров из избранного
   - Кнопка "Добавить в корзину"
   - Кнопка "Удалить из избранного"

8. **Акции и распродажи** (`/promotions`)
   - Список активных акций
   - Баннеры акций
   - Товары, участвующие в акции

9. **Статические страницы**:
   - О компании (`/about`)
   - Доставка и оплата (`/delivery`)
   - Гарантии (`/warranty`)
   - Контакты (`/contacts`)
   - Политика конфиденциальности (`/privacy`)
   - Пользовательское соглашение (`/terms`)

#### Опциональные (на будущее):
- Сравнение товаров
- Блог (будет на YouTube, на сайте только ссылки)
- Программа лояльности

---

## 4. ДЕТАЛЬНОЕ ОПИСАНИЕ ГЛАВНОЙ СТРАНИЦЫ

### 4.1 Header (sticky)
```
┌────────────────────────────────────────────────────────────┐
│ [Логотип] | Каталог | О нас | Акции | Контакты | YouTube  │
│                                          [🔍] [❤️(3)] [🛒(2)]│
└────────────────────────────────────────────────────────────┘
```

**Элементы**:
- Логотип (слева, кликабелен → главная)
- Навигационное меню
- Поиск (иконка, раскрывается в input)
- Избранное (иконка сердца + счетчик)
- Корзина (иконка + счетчик)

**Технические требования**:
- Sticky позиция при скролле
- Мобильная версия: бургер-меню
- Z-index: 50 (над контентом)

---

### 4.2 Hero-слайдер (fullscreen)

**Дизайн концепция**:
```
┌────────────────────────────────────────────────────────────┐
│                                                             │
│  [◄]            Полноэкранное фото товара            [►]   │
│                  (с затемнением 30%)                        │
│                                                             │
│  ┌─────────────────────────┐                               │
│  │ Охотничий нож "Медведь" │     ← Карточка с инфо        │
│  │ Сталь: AUS-8            │       (левый нижний угол)     │
│  │ Длина: 240 мм           │                               │
│  │ ₽ 12 990                │                               │
│  │ [Смотреть товар →]      │                               │
│  └─────────────────────────┘                               │
│                                                             │
│           ━━━━  ━━━━  ━━━━  ━━━━  ← Линейные индикаторы  │
└────────────────────────────────────────────────────────────┘
```

**Требования**:
- **Изображения**: Полноэкранные (1920x1080 минимум), WebP формат
- **Количество слайдов**: 3-5 товаров
- **Автопрокрутка**: каждые 5 секунд, останавливается при взаимодействии
- **Навигация**: 
  - Стрелки по бокам (полупрозрачные кнопки)
  - Линейные индикаторы внизу (не точки!)
- **Карточка товара**:
  - Фон: `bg-white/95 backdrop-blur-sm`
  - Padding: 32px
  - Закругленные углы: 8px
  - Тень: `shadow-2xl`
  - Содержимое:
    - Название (h2, 3xl, bold)
    - Подзаголовок (опционально)
    - 2-3 ключевые характеристики
    - Цена (3xl, bold)
    - Кнопка CTA (красная, `bg-red-600`)

**Альтернативное расположение карточки**:
- Вариант 1: Левый нижний угол (основной)
- Вариант 2: Правый нижний угол
- Вариант 3: По центру (полупрозрачный фон)

**Код индикаторов** (линии, не точки):
```jsx
<div className="flex gap-3">
  {slides.map((_, index) => (
    <div
      className={`h-1 rounded-full transition-all ${
        index === currentSlide
          ? 'w-16 bg-white'
          : 'w-8 bg-white/50'
      }`}
    />
  ))}
</div>
```

**Источник товаров для слайдера**:
- Django: поле `Product.is_featured = True`
- Выбираются случайно или по порядку
- API endpoint: `/api/products/featured/`

---

### 4.3 Секция "Новинки"

**Layout**:
```
┌────────────────────────────────────────────────────────────┐
│                        Новинки                              │
│                                                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  │
│  │  [Фото]  │  │  [Фото]  │  │  [Фото]  │  │  [Фото]  │  │
│  │  300x300 │  │  300x300 │  │  300x300 │  │  300x300 │  │
│  │          │  │          │  │          │  │          │  │
│  │ Название │  │ Название │  │ Название │  │ Название │  │
│  │ ₽ 7 990  │  │ ₽ 5 490  │  │ ₽ 12 990 │  │ ₽ 8 990  │  │
│  │ [🛒]     │  │ [🛒]     │  │ [🛒]     │  │ [🛒]     │  │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘  │
│                                                             │
│  ┌──────────┐  ┌──────────┐                                │
│  │  ...     │  │  ...     │                                │
│  └──────────┘  └──────────┘                                │
│                                                             │
│              [Смотреть весь каталог →]                     │
└────────────────────────────────────────────────────────────┘
```

**Требования**:
- **Количество товаров**: 4-6 штук
- **Источник**: `Product.is_new = True`, отсортированные по дате создания
- **Grid**: 
  - Desktop: 4 колонки
  - Tablet: 2 колонки
  - Mobile: 1 колонка
- **Gap**: 24px между карточками
- **Кнопка внизу**: Ссылка на каталог с иконкой стрелки вправо

---

### 4.4 Секция "Популярные категории"

**Layout**:
```
┌────────────────────────────────────────────────────────────┐
│              Популярные категории                           │
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌────────────┐ │
│  │    [Иконка]     │  │    [Иконка]     │  │  [Иконка]  │ │
│  │      🔪         │  │      🪓         │  │    ⚔️      │ │
│  │                 │  │                 │  │            │ │
│  │     Ножи        │  │     Топоры      │  │   Мачете   │ │
│  │   42 товара     │  │   18 товаров    │  │ 8 товаров  │ │
│  └─────────────────┘  └─────────────────┘  └────────────┘ │
└────────────────────────────────────────────────────────────┘
```

**Требования**:
- **Количество категорий**: 3-4 штуки
- **Источник**: Основные категории из базы (без подкатегорий)
- **Дизайн блока**:
  - Фон: белый (`bg-white`)
  - Padding: 32px
  - Закругленные углы: 8px
  - Тень: `shadow-sm`, при hover: `shadow-md`
  - Иконка: 64px, по центру
  - Название: 20px, semibold
  - Счетчик: 14px, серый
- **Hover эффект**: название меняет цвет на красный
- **Клик**: переход в каталог с фильтром по категории

---

### 4.5 Секция "Преимущества"

**Layout**:
```
┌────────────────────────────────────────────────────────────┐
│                  Почему выбирают нас                        │
│                                                             │
│     [📦]              [✓]              [🛡️]                │
│  Доставка          Гарантия         Качество               │
│  по всей РФ        12 месяцев       Ручная работа          │
│  Быстрая и         Полная           Каждое изделие         │
│  надежная          гарантия         создается мастерами    │
└────────────────────────────────────────────────────────────┘
```

**Требования**:
- **Количество блоков**: 3 штуки
- **Иконки**: из библиотеки lucide-react (Truck, Shield, Award)
- **Размер иконок**: 64px в круге с фоном `bg-red-100`
- **Текст**: 
  - Заголовок: 20px, semibold
  - Описание: 16px, серый
- **Выравнивание**: по центру

---

### 4.6 Footer

**Layout**:
```
┌────────────────────────────────────────────────────────────┐
│  [Логотип]                                                  │
│                                                             │
│  О компании     Покупателям      Контакты                  │
│  - О нас        - Доставка       📧 info@shop.ru           │
│  - Гарантии     - Оплата         📱 +7 (999) 123-45-67     │
│                 - Возврат        📍 Москва, ул. ...        │
│                                                             │
│  Мы в соцсетях: [YouTube] [VK] [Telegram]                  │
│                                                             │
│  © 2025 Мастерская ножей | Политика конфиденциальности    │
└────────────────────────────────────────────────────────────┘
```

**Требования**:
- **Фон**: темный (`bg-gray-900`)
- **Текст**: белый/серый
- **Ссылки**: с hover эффектом
- **Responsive**: на мобильных колонки друг под другом

---

## 5. КАТАЛОГ ТОВАРОВ

### 5.1 Структура страницы

```
┌─────────────┬──────────────────────────────────────────────┐
│             │  [Сортировка ▼]  [Grid/List]  🔍 Поиск      │
│  Фильтры    ├──────────────────────────────────────────────┤
│  (Sidebar)  │  Показано 24 из 87 товаров                   │
│             ├──────────────────────────────────────────────┤
│ Категории   │  ┌────┬────┬────┬────┐                      │
│ ☐ Ножи      │  │img │img │img │img │                      │
│   ☐ Охот.   │  │    │    │    │    │                      │
│   ☐ Тур.    │  └────┴────┴────┴────┘                      │
│ ☐ Топоры    │  ┌────┬────┬────┬────┐                      │
│             │  │img │img │img │img │                      │
│ Цена        │  │    │    │    │    │                      │
│ [════•════] │  └────┴────┴────┴────┘                      │
│ 1000  50000 │                                              │
│             │  [Загрузить еще ▼]                           │
│ Длина клинка│                                              │
│ [════•════] │                                              │
│ 80    250мм │                                              │
│             │                                              │
│ Материал    │                                              │
│ ☐ VG-10     │                                              │
│ ☐ AUS-8     │                                              │
│ ☐ D2        │                                              │
│             │                                              │
│ [Сбросить]  │                                              │
└─────────────┴──────────────────────────────────────────────┘
```

### 5.2 Фильтры (детально)

**Обязательные фильтры**:
1. **Категории** (чекбоксы, древовидная структура)
2. **Цена** (range slider, мин/макс инпуты)
3. **Длина клинка** (range slider, мм)
4. **Общая длина** (range slider, мм)
5. **Вес** (range slider, граммы)
6. **Материал клинка** (чекбоксы)
7. **Материал рукояти** (чекбоксы)
8. **Твердость HRC** (range slider)
9. **Назначение** (чекбоксы: туризм, охота, EDC, коллекция)
10. **Статус** (радио: все / в наличии / под заказ)

**Технические требования**:
- Range sliders: использовать компонент из shadcn/ui
- Debounce для слайдеров: 300ms
- URL-параметры для всех фильтров (для SEO и шарабельности)
- Пример URL: `/catalog?category=knives&price_min=5000&price_max=15000&blade_material=vg10`
- Кнопка "Сбросить фильтры" внизу sidebar
- Счетчик активных фильтров в header

**Мобильная версия**:
- Фильтры в Bottom Sheet (Material UI)
- Кнопка "Фильтры" с бейджем количества активных фильтров
- Кнопки "Применить" и "Сбросить" внизу Bottom Sheet

### 5.3 Сортировка

**Опции**:
- По популярности (по умолчанию)
- По цене: дешевле → дороже
- По цене: дороже → дешевле
- По новизне (сначала новые)
- По названию (А-Я)

**Технические требования**:
- Dropdown компонент
- Сохранение в URL: `?sort=price_asc`
- Иконка направления сортировки

### 5.4 Grid товаров

**Требования**:
- Desktop: 4 колонки
- Tablet: 3 колонки
- Mobile: 2 колонки (или 1 в list mode)
- Gap: 24px
- Skeleton loaders при загрузке (shadcn/ui Skeleton)

### 5.5 Пагинация

**Варианты**:
1. **Классическая** (страницы 1, 2, 3...)
2. **Infinite scroll** (рекомендуется для UX)
3. **"Загрузить еще"** (кнопка)

**Рекомендация**: Infinite scroll с индикатором загрузки

---

## 6. КАРТОЧКА ТОВАРА

### 6.1 Layout

```
┌────────────────────────────────────────────────────────────┐
│  Главная > Каталог > Ножи > Охотничий нож "Медведь"       │
├────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐  Охотничий нож "Медведь"             │
│  │                 │  ⭐⭐⭐⭐⭐ 4.8 (12 отзывов)            │
│  │   Основное      │                                        │
│  │   фото          │  Артикул: NK-001                       │
│  │   800x600       │  ✓ В наличии                           │
│  │                 │                                        │
│  ├─────────────────┤  ₽ 12 990                              │
│  │ [▢][▢][▢][▢]   │                                        │
│  └─────────────────┘  [Добавить в корзину]  [❤️ В избранное]│
│      Thumbnails       [Купить в 1 клик]                     │
│                                                             │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                             │
│  Характеристики:                                           │
│  ┌─────────────────────────────────────────────────────┐  │
│  │ Длина клинка      │ 150 мм                          │  │
│  │ Общая длина       │ 280 мм                          │  │
│  │ Вес               │ 320 г                           │  │
│  │ Материал клинка   │ AUS-8                           │  │
│  │ Твердость         │ 58-60 HRC                       │  │
│  │ Материал рукояти  │ Карельская береза               │  │
│  │ Назначение        │ Охота, туризм                   │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                             │
│  [Табы: Описание | Отзывы (12) | Доставка]                │
│                                                             │
│  [Активная вкладка с контентом]                            │
│                                                             │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                             │
│  Похожие товары                                            │
│  [Слайдер с 4-6 товарами]                                  │
└────────────────────────────────────────────────────────────┘
```

### 6.2 Галерея изображений

**Требования**:
- **Основное фото**: 800x600px (aspect ratio 4:3)
- **Thumbnails**: 100x75px, до 8 штук
- **Lightbox**: При клике на основное фото открывается полноэкранная галерея
- **Навигация**: 
  - Клик по thumbnail → меняет основное фото
  - Стрелки влево/вправо
  - Свайп на мобильных
- **Zoom**: При hover на desktop (опционально)

**Библиотека**: `yet-another-react-lightbox`

### 6.3 Блок информации

**Элементы**:
1. **Название** (h1, 2.5rem, bold)
2. **Рейтинг** (звезды + средний балл + количество отзывов)
3. **Артикул** (серый, мелкий текст)
4. **Статус наличия**:
   - ✓ В наличии (зеленый)
   - ⏱ Под заказ (синий, + срок изготовления)
   - ✗ Нет в наличии (серый)
5. **Цена** (3rem, bold, красный если скидка)
   - Если скидка: зачеркнутая старая цена
   - Процент скидки в бейдже
6. **Кнопки**:
   - "Добавить в корзину" (большая, красная)
   - "Купить в 1 клик" (второстепенная, белая с обводкой)
   - "В избранное" (иконка сердца)

### 6.4 Таблица характеристик

**Формат**: Две колонки (название характеристики | значение)

**Обязательные характеристики**:
- Длина клинка (мм)
- Общая длина (мм)
- Вес (г)
- Толщина клинка (мм)
- Материал клинка
- Твердость (HRC)
- Материал рукояти
- Назначение
- Тип заточки
- Наличие ножен (да/нет, материал)

**Дополнительные** (из JSONB поля `specifications`):
- Форма клинка
- Тип замка (для складных)
- Производитель
- Страна
- и т.д.

### 6.5 Табы с контентом

**Вкладка "Описание"**:
- Rich text (HTML)
- Поддержка форматирования: bold, italic, списки, заголовки
- Изображения (опционально)
- Видео YouTube (embed, опционально)

**Вкладка "Отзывы"**:
- См. раздел 7 "Система отзывов"

**Вкладка "Доставка"**:
- Информация о способах доставки
- Сроки
- Стоимость
- Условия возврата

### 6.6 Похожие товары

**Логика подбора**:
1. Та же категория
2. Близкий ценовой диапазон (±30%)
3. Исключить текущий товар
4. Лимит: 6 штук

**UI**: Swiper слайдер с карточками товаров

---

## 7. СИСТЕМА ОТЗЫВОВ

### 7.1 Модель данных (Django)

```python
class Review(models.Model):
    product = ForeignKey(Product)
    user = ForeignKey(User)
    
    # Оценка
    rating = IntegerField(1-5)
    
    # Контент
    title = CharField(max_length=200)
    text = TextField()
    pros = TextField(blank=True)  # Достоинства
    cons = TextField(blank=True)  # Недостатки
    
    # Модерация
    is_approved = BooleanField(default=False)
    
    # Метаданные
    is_verified_buyer = BooleanField(default=False)  # Проверенная покупка
    helpful_count = IntegerField(default=0)  # Сколько отметили "Полезно"
    
    created_at = DateTimeField(auto_now_add=True)
    
    class Meta:
        unique_together = ['product', 'user']  # 1 отзыв на товар от пользователя

class ReviewImage(models.Model):
    review = ForeignKey(Review)
    image = ImageField(upload_to='reviews/')
    order = IntegerField(default=0)

class ReviewHelpful(models.Model):
    review = ForeignKey(Review)
    user = ForeignKey(User)
    created_at = DateTimeField(auto_now_add=True)
    
    class Meta:
        unique_together = ['review', 'user']
```

### 7.2 UI отзывов

**Блок с общей информацией**:
```
┌────────────────────┬──────────────────────────────────────┐
│                    │                                      │
│       4.8          │  5 ★  ████████████████████  (8)     │
│   ⭐⭐⭐⭐⭐        │  4 ★  ██████████░░░░░░░░░  (3)     │
│                    │  3 ★  ██░░░░░░░░░░░░░░░░  (1)     │
│   12 отзывов       │  2 ★  